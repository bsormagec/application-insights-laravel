!function(e,t){"use strict";function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function r(){var e=sessionStorage.getItem("ai_session_start");return e?Date.now()-parseInt(e,10):0}var i,a,s,o,c={queue:[],batchSize:10,retryLimit:3,retryDelay:1e3,collectEndpoint:e.AppInsightsConfig?.collectEndpoint||"/appinsights/collect",appId:e.AppInsightsConfig?.appId||(s="ai_app_id",o=("; "+t.cookie).split("; "+s+"="),2==o.length?o.pop().split(";").shift():null)||null,operationId:e.AppInsightsConfig?.operationId||n(),parentId:e.AppInsightsConfig?.parentId||null,operationName:e.AppInsightsConfig?.operationName||null,excludedPaths:e.AppInsightsConfig?.excludedPaths||[],trackDependencies:!1!==e.AppInsightsConfig?.trackDependencies,normalizeDependencyUrls:!1!==e.AppInsightsConfig?.normalizeDependencyUrls,pageViewSent:!1,userId:(a=localStorage.getItem("ai_user_id"),a||(a=n(),localStorage.setItem("ai_user_id",a)),a),sessionId:(i=sessionStorage.getItem("ai_session_id"),i||(i=n(),sessionStorage.setItem("ai_session_id",i),sessionStorage.setItem("ai_session_start",Date.now().toString())),i),isPathExcluded:function(t){if(!this.excludedPaths||0===this.excludedPaths.length)return!1;try{for(var n=new URL(t,e.location.origin).pathname.replace(/^\//,""),r=0;r<this.excludedPaths.length;r++){var i=this.excludedPaths[r];if(this.pathMatchesPattern(n,i))return!0}}catch(e){}return!1},pathMatchesPattern:function(e,t){if(e===t)return!0;var n=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*");return(n=new RegExp("^"+n+"$")).test(e)},normalizeDependencyName:function(e,t){return this.normalizeDependencyUrls?e+" "+this.normalizeUrlPath(t):e+" "+t},getDependencyDisplayName:function(e,t,n,r){return n?e+" "+n:r?e+" "+r:this.normalizeDependencyName(e,t)},normalizeUrlPath:function(t){try{var n=new URL(t,e.location.origin);return this.normalizePath(n.pathname||"/")}catch(e){var r=t.split("#")[0].split("?")[0];return this.normalizePath(r||"/")}},normalizePath:function(e){var t=e||"/";"/"!==t.charAt(0)&&(t="/"+t);for(var n=t.split("/"),r=0;r<n.length;r++){var i=n[r];i&&(this.isDynamicSegment(i)&&(n[r]="{id}"))}return n.join("/").replace(/\/{2,}/g,"/")},isDynamicSegment:function(e){return!!/^\d+$/.test(e)||(!!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||!!/^[0-9a-f]{16,}$/i.test(e))},getContext:function(){return{userId:this.userId,sessionId:this.sessionId,sessionDuration:r(),url:e.location.href,referrer:t.referrer||null,operationId:this.operationId,parentId:this.parentId}},getPageName:function(){if(this.operationName)return this.operationName;var t=e.location.pathname;return(t=t.replace(/^\/+|\/+$/g,""))&&""!==t?t:"Home"},trackEvent:function(e,t){t=t||{},t=Object.assign({},this.getContext(),t),this.queue.push({type:"event",name:e,properties:t}),this.queue.length>=this.batchSize&&this.flush()},trackPageView:function(t,n,r,i){r=r||{},i=i||{},r=Object.assign({},this.getContext(),r),this.queue.push({type:"pageView",name:t||this.getPageName(),url:n||e.location.href,properties:r,measurements:i}),this.flush()},trackMetric:function(e,t,n){n=n||{},n=Object.assign({},this.getContext(),n),this.queue.push({type:"metric",name:e,value:t,properties:n}),this.queue.length>=this.batchSize&&this.flush()},trackDependency:function(e,t,n,r,i,a,s){this.trackDependencies&&(a=a||{},a=Object.assign({},this.getContext(),a),s&&(a.correlationContext=s),this.queue.push({type:"dependency",name:e,url:t,duration:n,success:r,responseCode:i,properties:a,correlationContext:s}),this.queue.length>=this.batchSize&&this.flush())},trackBrowserTimings:function(){var n=this;"complete"===t.readyState?n._sendBrowserTimings():e.addEventListener("load",function(){setTimeout(function(){n._sendBrowserTimings()},100)})},_sendBrowserTimings:function(){if(!this.pageViewSent){this.pageViewSent=!0;var t=e.performance&&e.performance.timing,n=e.performance&&e.performance.getEntriesByType?e.performance.getEntriesByType("navigation")[0]:null,r={},i=Object.assign({},this.getContext(),{userAgent:navigator.userAgent,screenResolution:screen.width+"x"+screen.height,viewportSize:e.innerWidth+"x"+e.innerHeight});if(n)r.networkLatency=Math.round(n.responseStart-n.requestStart),r.serverResponseTime=Math.round(n.responseEnd-n.responseStart),r.domProcessingTime=Math.round(n.domContentLoadedEventEnd-n.responseEnd),r.pageLoadTime=Math.round(n.loadEventEnd-n.startTime),r.domContentLoadedTime=Math.round(n.domContentLoadedEventEnd-n.startTime),r.dnsLookupTime=Math.round(n.domainLookupEnd-n.domainLookupStart),r.tcpConnectTime=Math.round(n.connectEnd-n.connectStart),r.transferSize=n.transferSize||0;else if(t){var a=t.navigationStart;r.networkLatency=t.responseStart-t.requestStart,r.serverResponseTime=t.responseEnd-t.responseStart,r.domProcessingTime=t.domContentLoadedEventEnd-t.responseEnd,r.pageLoadTime=t.loadEventEnd-a,r.domContentLoadedTime=t.domContentLoadedEventEnd-a,r.dnsLookupTime=t.domainLookupEnd-t.domainLookupStart,r.tcpConnectTime=t.connectEnd-t.connectStart}for(var s in r)r[s]<=0&&delete r[s];this.queue.push({type:"pageView",name:this.getPageName(),url:e.location.href,properties:i,measurements:r}),Object.keys(r).length>0&&this.queue.push({type:"browserTimings",name:this.getPageName(),url:e.location.href,properties:i,measurements:r}),this.flush()}},trackException:function(e,t){t=t||{},t=Object.assign({},this.getContext(),t);try{e instanceof Error&&(e={message:e.message,stack:e.stack}),this.queue.push({type:"exception",error:e,properties:t}),this.queue.length>=this.batchSize&&this.flush()}catch(e){console.error("Failed to track exception:",e)}},flush:function(){if(this.collectEndpoint&&0!==this.queue.length){var e=this.queue.splice(0,this.batchSize);this.sendBatch(e,0)}},sendBatch:function(e,n){var r=this,i=t.querySelector('meta[name="csrf-token"]'),a={"Content-Type":"application/json"};i&&(a["X-CSRF-TOKEN"]=i.getAttribute("content"));try{fetch(this.collectEndpoint,{method:"POST",headers:a,body:JSON.stringify(e)}).then(function(e){if(!e.ok)throw new Error("HTTP error "+e.status)}).catch(function(t){n<r.retryLimit&&setTimeout(function(){r.sendBatch(e,n+1)},r.retryDelay*Math.pow(2,n))})}catch(e){console.error("Failed to flush telemetry batch:",e)}}};function u(e){if(!e)return null;var t=e.match(/appId=([^,\s]+)/);return t?t[1]:null}e.appInsights=c,c.trackDependencies&&function(){function t(){for(var e="",t=0;t<16;t++)e+="0123456789abcdef"[Math.floor(16*Math.random())];return e}var n=XMLHttpRequest.prototype.open,r=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(e,r){return this._aiMethod=e,this._aiUrl=r,this._aiStartTime=null,this._aiSpanId=t(),n.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){var e=this;e._aiStartTime=performance.now();try{if(e._aiUrl&&-1===e._aiUrl.indexOf("/appinsights/collect")){var t="|"+c.operationId+"."+e._aiSpanId;e.setRequestHeader("Request-Id",t);var n="00-"+c.operationId.replace(/-/g,"")+"-"+e._aiSpanId+"-01";e.setRequestHeader("traceparent",n),c.appId&&e.setRequestHeader("Request-Context","appId=cid-v1:"+c.appId)}}catch(e){}return e.addEventListener("loadend",function(){var t=performance.now()-e._aiStartTime,n=e.status>=200&&e.status<400;if(e._aiUrl&&-1===e._aiUrl.indexOf("/appinsights/collect")&&!c.isPathExcluded(e._aiUrl)){var r=null,i=null,a=null;try{r=u(e.getResponseHeader("Request-Context")),i=e.getResponseHeader("X-AI-Route-Pattern"),a=e.getResponseHeader("X-AI-Route-Name")}catch(e){}c.trackDependency(c.getDependencyDisplayName(e._aiMethod,e._aiUrl,i,a),e._aiUrl,Math.round(t),n,e.status,{type:"XHR",spanId:e._aiSpanId},r)}}),r.apply(this,arguments)};var i=e.fetch;e.fetch=function(e,n){var r="string"==typeof e?e:e.url,a=n&&n.method||"GET",s=performance.now(),o=t();if(-1===r.indexOf("/appinsights/collect")){(n=n||{}).headers=new Headers(n.headers||{});var p="|"+c.operationId+"."+o;n.headers.set("Request-Id",p);var d="00-"+c.operationId.replace(/-/g,"")+"-"+o+"-01";n.headers.set("traceparent",d),c.appId&&n.headers.set("Request-Context","appId=cid-v1:"+c.appId)}return i.call(this,e,n).then(function(e){var t=performance.now()-s,n=e.ok;if(-1===r.indexOf("/appinsights/collect")&&!c.isPathExcluded(r)){var i=null,p=null,d=null;try{i=u(e.headers.get("Request-Context")),p=e.headers.get("X-AI-Route-Pattern"),d=e.headers.get("X-AI-Route-Name")}catch(e){}c.trackDependency(c.getDependencyDisplayName(a,r,p,d),r,Math.round(t),n,e.status,{type:"Fetch",spanId:o},i)}return e}).catch(function(e){var t=performance.now()-s;throw-1!==r.indexOf("/appinsights/collect")||c.isPathExcluded(r)||c.trackDependency(c.getDependencyDisplayName(a,r,null,null),r,Math.round(t),!1,0,{type:"Fetch",error:e.message,spanId:o}),e})}}(),function(){if(e.PerformanceObserver){try{new PerformanceObserver(function(e){var t=e.getEntries(),n=t[t.length-1];c.trackMetric("WebVital_LCP",Math.round(n.startTime),{element:n.element?n.element.tagName:"unknown",size:n.size})}).observe({type:"largest-contentful-paint",buffered:!0})}catch(e){}try{new PerformanceObserver(function(e){e.getEntries().forEach(function(e){c.trackMetric("WebVital_FID",Math.round(e.processingStart-e.startTime),{name:e.name})})}).observe({type:"first-input",buffered:!0})}catch(e){}try{var n=0;new PerformanceObserver(function(e){e.getEntries().forEach(function(e){e.hadRecentInput||(n+=e.value)})}).observe({type:"layout-shift",buffered:!0}),e.addEventListener("visibilitychange",function(){"hidden"===t.visibilityState&&n>0&&(c.trackMetric("WebVital_CLS",Math.round(1e3*n)/1e3),c.flush())})}catch(e){}try{new PerformanceObserver(function(e){e.getEntries().forEach(function(e){"first-paint"===e.name?c.trackMetric("WebVital_FP",Math.round(e.startTime)):"first-contentful-paint"===e.name&&c.trackMetric("WebVital_FCP",Math.round(e.startTime))})}).observe({type:"paint",buffered:!0})}catch(e){}try{new PerformanceObserver(function(e){e.getEntries().forEach(function(e){c.trackMetric("LongTask",Math.round(e.duration),{attribution:e.attribution?e.attribution[0]?.name:"unknown"})})}).observe({type:"longtask",buffered:!0})}catch(e){}try{new PerformanceObserver(function(e){e.getEntries().forEach(function(e){e.interactionId&&c.trackMetric("WebVital_INP",Math.round(e.duration),{name:e.name,interactionId:e.interactionId})})}).observe({type:"event",buffered:!0,durationThreshold:40})}catch(e){}}}(),e.addEventListener("error",function(e){c.trackException({message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:e.error?e.error.stack:null}),c.flush()}),e.addEventListener("unhandledrejection",function(e){c.trackException({message:"Unhandled promise rejection",reason:String(e.reason)}),c.flush()}),e.addEventListener("beforeunload",function(){c.flush()}),e.addEventListener("visibilitychange",function(){"hidden"===t.visibilityState&&(c.trackEvent("SessionActivity",{duration:r()}),c.flush())}),c.trackBrowserTimings()}(window,document);